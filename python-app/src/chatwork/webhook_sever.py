# coding: utf-8
# $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


# $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
# import
from fastapi import FastAPI, Request

from ..utils.logger import Logger

# flow



# ----------------------------------------------------------------------------------
# **********************************************************************************

class ChatworkWebhookServer:
    def __init__(self):
        # logger
        self.getLogger = Logger()
        self.logger = self.getLogger.getLogger()

        self.app = FastAPI()

# ----------------------------------------------------------------------------------
# webhookのアクセスを検知して処理を実行するメソッド

    def process(self):
        pass


# ----------------------------------------------------------------------------------

    @app.post("/chatwork/webhook")
    async def chatwork_webhook(self, request: Request):
        data = await request.json()
        self.logger.info(f"Webhook受信: {data}")

        # TODO: Chatworkの内容を抽出して次の処理へ渡す
        return {"status": "ok"}

# ----------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------

# ----------------------------------------------------------------------------------



# **********************************************************************************

if __name__ == "__main__":
    ChatworkWebhookServer().process()

# ----------------------------------------------------------------------------------
